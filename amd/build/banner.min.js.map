{"version":3,"file":"banner.min.js","sources":["../src/banner.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Makes the banner closable\n *\n * @module     local_softwarewarning/banner\n * @copyright  2022 Justus Dieckmann WWU\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\nlet isenabled = true;\nlet iswwutheme = false;\nlet bannerparent;\nlet banner;\n\n// Theme wwu2019 stuff.\nlet fillelement;\nlet navbar;\n\n/**\n * Init\n */\nexport function init() {\n    iswwutheme = document.body.classList.contains('theme-wwu2019');\n    bannerparent = document.getElementById('banner-parent');\n    banner = bannerparent.querySelector('.softwarewarning-banner');\n    if (iswwutheme) {\n        fillelement = bannerparent.querySelector('.fill-element');\n        navbar = document.querySelector('nav#main-menu');\n    }\n    window.onresize = onResize;\n    // Setup close button.\n    document.querySelector('button.close[data-dismiss=\"banner\"]').onclick = (e) => {\n        e.preventDefault();\n        isenabled = false;\n        document.getElementById('banner-parent').remove();\n        document.body.classList.remove('withbanner');\n        document.cookie = `disablebrowserwarn=true` +\n            `;path=${new URL(M.cfg.wwwroot).pathname};SameSite=strict`;\n        if (iswwutheme) {\n            navbar.style.top = null;\n        } else {\n            document.body.style.height = null;\n            document.body.style['-ms-transform'] = null;\n            document.body.style['-webkit-transform'] = null;\n            document.body.style['-moz-transform'] = null;\n            document.body.style.transform = null;\n        }\n    };\n    onResize();\n}\n\n/**\n * Does things on resize.\n */\nfunction onResize() {\n    if (!isenabled) {\n        return;\n    }\n    const height = banner.clientHeight;\n    if (iswwutheme) {\n        fillelement.style.height = height + 'px';\n        navbar.style.top = height + 'px';\n    } else {\n        document.body.style.height = `calc(100% - ${height}px)`;\n        document.body.style['-ms-transform'] = `translateY(${height}px)`;\n        document.body.style['-webkit-transform'] = `translateY(${height}px)`;\n        document.body.style['-moz-transform'] = `translateY(${height}px)`;\n        document.body.style.transform = `translateY(${height}px)`;\n        bannerparent.style['-ms-transform'] = `translateY(-${height}px)`;\n        bannerparent.style['-webkit-transform'] = `translateY(-${height}px)`;\n        bannerparent.style['-moz-transform'] = `translateY(-${height}px)`;\n        bannerparent.style.transform = `translateY(-${height}px)`;\n    }\n}"],"names":["iswwutheme","document","body","classList","contains","bannerparent","getElementById","banner","querySelector","fillelement","navbar","window","onresize","onResize","onclick","e","preventDefault","isenabled","remove","cookie","URL","M","cfg","wwwroot","pathname","style","top","height","transform","clientHeight"],"mappings":"uJAmCIA,WAAaC,SAASC,KAAKC,UAAUC,SAAS,iBAC9CC,aAAeJ,SAASK,eAAe,iBACvCC,OAASF,aAAaG,cAAc,2BAChCR,aACAS,YAAcJ,aAAaG,cAAc,iBACzCE,OAAST,SAASO,cAAc,kBAEpCG,OAAOC,SAAWC,SAElBZ,SAASO,cAAc,uCAAuCM,QAAWC,IACrEA,EAAEC,iBACFC,WAAY,EACZhB,SAASK,eAAe,iBAAiBY,SACzCjB,SAASC,KAAKC,UAAUe,OAAO,cAC/BjB,SAASkB,OAAS,0CACL,IAAIC,IAAIC,EAAEC,IAAIC,SAASC,6BAChCxB,WACAU,OAAOe,MAAMC,IAAM,MAEnBzB,SAASC,KAAKuB,MAAME,OAAS,KAC7B1B,SAASC,KAAKuB,MAAM,iBAAmB,KACvCxB,SAASC,KAAKuB,MAAM,qBAAuB,KAC3CxB,SAASC,KAAKuB,MAAM,kBAAoB,KACxCxB,SAASC,KAAKuB,MAAMG,UAAY,OAGxCf;;;;;;;;IArCAR,aACAE,OAGAE,YACAC,OAPAO,WAAY,EACZjB,YAAa,WA4CRa,eACAI,uBAGCU,OAASpB,OAAOsB,aAClB7B,YACAS,YAAYgB,MAAME,OAASA,OAAS,KACpCjB,OAAOe,MAAMC,IAAMC,OAAS,OAE5B1B,SAASC,KAAKuB,MAAME,6BAAwBA,cAC5C1B,SAASC,KAAKuB,MAAM,sCAAiCE,cACrD1B,SAASC,KAAKuB,MAAM,0CAAqCE,cACzD1B,SAASC,KAAKuB,MAAM,uCAAkCE,cACtD1B,SAASC,KAAKuB,MAAMG,+BAA0BD,cAC9CtB,aAAaoB,MAAM,uCAAkCE,cACrDtB,aAAaoB,MAAM,2CAAsCE,cACzDtB,aAAaoB,MAAM,wCAAmCE,cACtDtB,aAAaoB,MAAMG,gCAA2BD"}